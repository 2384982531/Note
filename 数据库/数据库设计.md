# 需求分析

1. 登录功能（图片验证码）
2. 注册功能（上传头像），基于forms
3. 首页
4. 景点
5. 评论功能
6. 后台管理
7. 发布

# 数据库设计

1. 用户表
2. 景点表
   - 跟分类表：一对多
   - 跟标签表：一对多
3. 分类表
   - 跟景点一对多（一个分类对应着多个景点）
4. 标签表
   - 跟景点多对多（一个景点对多个标签，一个标签对多个景点）
5. 评论表
   - 跟用户表：一对多
   - 跟景点表：一对多

# 表的功能

- 用户信息表

  | 字段名称      | 类型         | 备注                               | 约束                  |
  | ------------- | ------------ | ---------------------------------- | --------------------- |
  | user_id       | int          | 用户ID                             | 主键，自增长，增量为1 |
  | user_nickname | varchar(32)  | 用户昵称                           | 默认为用户名          |
  | username      | varchar(32)  | 用户名                             | 非空                  |
  | password      | varchar(32)  | 密码                               | 非空                  |
  | user_sex      | varchar(6)   | 性别，0为男，1为女，               | 默认值为0             |
  | email         | varchar(64)  | 邮箱                               | 非空                  |
  | avator        | varchar(255) | 头像地址                           | 无                    |
  | is_superuser  | int          | 是否是管理员 `0`代表不是 `1`代表是 | 默认值为0             |
  | last_login    | datetime     | 上一次登陆时间                     | 无                    |
  | create_time   | datetime     | 用户注册时间                       | 无                    |

- 博客分类表

  | 字段名称      | 类型        | 备注     | 约束                    |
  | ------------- | ----------- | -------- | ----------------------- |
  | category_id   | int         | 分类 ID  | 主键，自动增长，增量为1 |
  | category_name | varchar(32) | 分类名称 | 非空                    |

- 博客信息表

  | 字段名称    | 类型         | 备注                     | 约束                    |
  | ----------- | ------------ | ------------------------ | ----------------------- |
  | nid         | int          | 博客ID                   | 主键，自动增长，增量为1 |
  | title       | varchar(100) | 博客标题                 | 非空                    |
  | content     | text         | 博客内容                 | 非空                    |
  | user        | int          | 创建人ID                 | 外键                    |
  | category    | int          | 分类ID                   | 外键                    |
  | blog_status | int          | 博客状态 1为发布 0为草稿 | 非空，默认为0           |
  | create_time | datetime     | 创建时间                 | 非空                    |
  | update_time | datetime     | 更新时间                 | 非空                    |
  | cover_image | varchar(255) | 封面图片                 | 无                      |

- 评论表

  | 字段名称        | 类型         | 备注       | 约束                    |
  | --------------- | ------------ | ---------- | ----------------------- |
  | comment_id      | int          | 评论ID     | 主键，自动增长，增量为1 |
  | comment_content | varchar(500) | 评论内容   | 非空                    |
  | blog_id         | int          | 评论博客   | 非空，外键              |
  | user_id         | int          | 评论人ID   | 非空，外键              |
  | replyid         | int          | 评论回复人 | 非空                    |
  | create_time     | datetime     | 评论时间   | 非空                    |
  | comment_place   | varchar(255) | 评论地点   | 非空                    |

  
