# 计算机组成与体系结构

# 数据的表示

1. R进制转十进制使用按权展开法

   > 将R进制数的每一位数值用${R^k}$形式表示，即幂的底数是R，指数为k，k与该位和小数点之间的距离有关。当该位位于小数点左边，k值是该位和小数点之间数码的个数，而当该位位于小数点右边，k值是负值，其绝对值是该位和小数点之间数码的个数加1。
   >
   > ${例如二进制10100.01=1×2^4+1×2^2+1×2^{-2}}$
   >
   > ${例如七进制604.01=6×7^2+4×7^0+1×7^{-2}}$
   >
2. 十进制转R进制使用短除法
3. 二进制与八进制和十六进制互相转换

   > 一个八进制数对应三位二进制
   >
   > 一个十六进制数对应四位二进制
   >
4. 原码，反码，补码，移码

   ||1|-1|1-1|1-1的结果|表示范围（n是比特位数）|
   | ----| ----------| ---------| ---------| ---------| -----------------------|
   |原码|0000 0001|1000 0001|1000 0010|-2|${-(2^{n-1}-1)\sim 2^{n-1}-1}$|
   |反码|0000 0001|1111 1110|1111 1110|-0|${-(2^{n-1}-1) \sim 2^{n-1}-1}$|
   |补码|0000 0001|1111 1111|1111 1111|0|${-2^{n-1} \sim 2^{n-1}-1}$|
   |移码|1000  0001|0111 1111|1000 0000|0||
5. 浮点数运算

   > 浮点数表示：${N=M\times R^e}$
   >
   > M称为尾数，e是指数，R为基数
   >

# 计算机结构

### 主机

- 主存储器
  - 运算器
    1. 算术逻辑单元ALU
    2. 累加寄存器AC
    3. 数据缓冲寄存器DR
    4. 状态条件寄存器PSW
  - 控制器
    1. 程序计数器PC
    2. 指令寄存器IR
    3. 指令译码器
    4. 时序部件
- CPU

## 计算机体系结构分类

|体系结构类型|结构|关键特性|代表|
| --------------------| ----------------------------------------------------------------------| --------------------------------------| ----------------------------------------------|
|单指令流单数据流SISD|控制部分：一个                <br />  处理器：一个<br />主存模块：一个||单处理器系统|
|单指令流多数据流SIMD|控制部分：一个<br />处理器：多个<br />主存模块：多个|多处理器以异步的形式执行同一条指令|并行处理机<br />陈列处理机<br />超级向量处理机|
|多指令流单数据流MISD|控制部分：多个<br />处理器：一个<br />主存模块：多个|被证明不可能，至少是不实际|目前没有，有文献称流水线计算机为此类|
|多指令流多数据流MIMD|控制部分：多个<br />处理器：多个<br />主存模块：多个|能够实现作业，任务，指令等各级全面并行|多处理机系统多计算机|

## CISC与RISC

|指令系统类型|指令|寻址方式|实现方式|其它|
| ------------| --------------------------------------------------------------------------------------| -----------| ----------------------------------------------------| --------------------------|
|CISC(复杂)|数量多，使用频率差别大，可变长格式|支持多种|微程序控制技术（微码）|研制周期长|
|RISC（精简）|数量少，使用频率接近，定长格式，大部分为单周期指令，操作寄存器，只有Load/Store操作内存|支持方式 少|增加了通用寄存器；硬布线逻辑控制为主，适合采用流水线|优化编译，有效支持高级语言|

# 流水线

## 概念

> 流水线是指在程序执行时多条指令重叠进行操作的一种准并行处理实现技术。各种部件同时处理是针对不同指令而言的，它们可同时为多条指令的不同部分进行工作，以提高各部件的利用率和指令的平均执行速度

![](https://noclose-image.oss-cn-hangzhou.aliyuncs.com/img/%E8%BD%AF%E8%80%83/Snipaste_2023-07-03_20-39-28.png)

## 流水线计算

> - 流水线周期为执行时间最长的一段
> - 流水线计算公式
>
>   ${一条 指令执行时间+（指令条数-1） \times 流水线周期}$
>
>   $理论公式：（t_1+t_2+..+t_k)\times \Delta t$
>
>   ${实际公式：(k+n-1)\times \Delta t}$

## 流水线吞吐率计算

> 流水线的吞吐率(Though Put rate，TP)是指在单位时间内流水线所完成的任务数量或输出的结果数量。计算流水线吞吐率的最基本的公式如下：
>
> $$
> TP = \frac{指令条数}{流水线执行时间}
> $$
>
> 流水线最大吞吐率
>
> $$
> TP_{max} = \lim_{n \to \infty} \frac{n}{(k+n-1) \Delta t} = \frac{1}{\Delta t}
> $$

## 流水线的加速比

> 完成同样一批任务，不使用流水线所用的时间与使用流水线所用的时间之比称为流水线的加速比。计算流水线加速比的基本公式如下：
>
> $$
> S = \frac{不使用流水线执行时间}{使用流水线执行时间}
> $$

## 流水线的效率

> 流水线的效率是指流水线的设备利用率。在时空图上，流水线的效率定义为n个任务占用的时空区与k个流水段总的时空区之比
>
> $$
> E = \frac{n个任务占用的时空区}{k个流水段的总的时空区} = \frac{T_0}{kT_k}
> $$

# 层次化存储结构

![Snipaste_2023-07-04_07-29-49](https://noclose-image.oss-cn-hangzhou.aliyuncs.com/img/%E8%BD%AF%E8%80%83/Snipaste_2023-07-04_07-29-49.png)

## Cache

> Cache的功能：提高CPU数据输入输出的速率，突破冯·诺依曼瓶颈，即CPU与存储系统间数据传送带宽限制。
>
> 在计算机的存储系统体系中，Cache是访问速度最快的层次。
>
> 使用Cache改善系统性能的依据是程序的局部性原理。

$$
如果以h代表对Cache的访问命中率，t_1表示Cache的周期时间，t_2表示主存储器周期 \\
时间，以读操作为例，使用“Cache+主存储器”的系统的平均周期为t_3则： \\
t_3 = h \times t_1 +(1-h)\times t_2 \\
其中，(1-h)又称为失效率(未命中率)
$$

## 局部性原理

1. 时间局部性
2. 空间局部性
3. 工作集理论
   1. 工作集是进程运行时被频繁访问的页面集合

## 主存

- 随机存取存储器
  - DRAM（Dynamic RAM，动态RAM）-SDRAM
  - SRAM（Static RAM，静态RAM）
- 只读存储器
  - MROM（Mask ROM，掩模式ROM）
  - PROM（Programmable ROM，一次可编程ROM）
  - EPROM（Erasable PROM，可擦除的PROM）
  - 闪速存储器（flash memory，闪存）

## 磁盘工作原理

![Snipaste_2023-07-04_07-58-16](https://noclose-image.oss-cn-hangzhou.aliyuncs.com/img/%E8%BD%AF%E8%80%83/Snipaste_2023-07-04_07-58-16.png)

${存取时间 = 寻道时间+等待时间(平均定位时间+转动延迟)}$

注意：寻道时间是指磁头移动到磁道所需的时间；等待时间为等待读写的扇区转到磁头下方所用的时间

## 总线

> 根据总线所处的位置不同，总线通常被分成三种类型，分别是

- 内部总线
- 系统总线
  - 数据总线
  - 地址总线
  - 控制总线
- 外部总线

# 系统可靠性分析与设计

- 串联系统

  ![Snipaste_2023-07-04_08-16-49](https://noclose-image.oss-cn-hangzhou.aliyuncs.com/img/%E8%BD%AF%E8%80%83/Snipaste_2023-07-04_08-16-49.png)

  > R为可靠性
  >
- 并联系统

  ![Snipaste_2023-07-04_08-17-22](https://noclose-image.oss-cn-hangzhou.aliyuncs.com/img/%E8%BD%AF%E8%80%83/Snipaste_2023-07-04_08-17-22.png)
- 摸冗余系统

  ![Snipaste_2023-07-04_08-18-49](https://noclose-image.oss-cn-hangzhou.aliyuncs.com/img/%E8%BD%AF%E8%80%83/Snipaste_2023-07-04_08-18-49.png)
- 混合系统

  ![Snipaste_2023-07-04_08-20-24](https://noclose-image.oss-cn-hangzhou.aliyuncs.com/img/%E8%BD%AF%E8%80%83/Snipaste_2023-07-04_08-20-24.png)

## 差错控制

- 码距

  - 一个编码系统的码距是整个编码系统中任意（所有）两个码字的最小距离。
  - 例：
    - 若用1位长度的二进制编码。若A=1，B=0。这样A，B之间的最小码距为1。
    - 若用2位长度的二进制编码，若以A=11，B=00为例，A、B之间的最小码距为2。
    - 若用3位长度的二进制编码，可选用111，000作为合法编码。A，B之间的最小码距为3。
- 码距与检错，纠错的关系

  - 在一个码组内为了检测e个误码，要求最小码距d应该满足：d>=e+l
  - 在一个码组内为了纠正t个误码，要求最小码距d应该满足：d>=2t+1
- 海明校验码

  ![Snipaste_2023-07-04_08-38-11](https://noclose-image.oss-cn-hangzhou.aliyuncs.com/img/%E8%BD%AF%E8%80%83/Snipaste_2023-07-04_08-38-11.png)
